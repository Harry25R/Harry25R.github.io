import{getProjects as t,getPublications as e,getTalks as s}from"./data.js";import{escapeHTML as l}from"./utils.js";const a=(t,e,s)=>e.length?`<p><span class="font-semibold text-slate-900 dark:text-white">${t} (${e.length})</span> â€” ${e.map(s).join(", ")}</p>`:"";export async function initTechstack(i=document){const r=i.querySelector("[data-techstack]");if(!r)return;const n=Array.from(r.querySelectorAll("[data-skill]")),o=r.querySelector("[data-skill-results]");if(0===n.length||!o)return;const[c,d,u]=await Promise.all([t(),e(),s()]);let f=null;n.forEach(t=>{t.setAttribute("aria-pressed","false"),t.addEventListener("click",()=>{f=t.dataset.skill===f?null:t.dataset.skill,n.forEach(t=>{const e=t.dataset.skill===f;t.setAttribute("aria-pressed",e?"true":"false"),t.classList.toggle("bg-blue-600",e),t.classList.toggle("text-white",e)}),(t=>{if(!t)return void(o.innerHTML='<p class="text-slate-600 dark:text-slate-400">Select a skill to surface related work. All content remains visible without JavaScript.</p>');const e=c.filter(e=>e.tags?.includes(t)),s=d.filter(e=>e.tags?.includes(t)),i=u.filter(e=>e.tags?.includes(t)),r=[a("Projects",e,t=>l(t.title)),a("Publications",s,t=>l(t.title)),a("Talks",i,t=>l(t.title))].filter(Boolean);o.innerHTML=r.length?`<div class="space-y-2 text-sm text-slate-600 dark:text-slate-300">${r.join("")}</div>`:`<p class="text-slate-600 dark:text-slate-400">No highlighted work for ${l(t)} just yet.</p>`})(f)})})}